# Maintainer: Denis Benato <benato.denis96@gmail.com>

pkgname=chimeraos-dracut-cfg
pkgver=0.0.1
pkgrel=1
pkgdesc="Dracut-specific configuration for chimeraos"
arch=('any')
url="https://github.com/ChimeraOS/chimeraos"
license=('MIT')
depends=('dracut' 'plymouth')
source=(
    "dracut-install.sh"
    "dracut-remove.sh"
    "00-chimeraos.conf"
    "10-chimeraos_use-fstab.conf"
    "20-chimeraos_include-plymouth.conf"
    "30-chimeraos_include-filesystems.conf"
    "40-chimeraos_exclude-encryption.conf"
    "50-chimeraos_exclude-mdraid.conf"
    "60-chimeraos_exclude-networking.conf"
    "70-chimeraos_exclude-nvdimm.conf"
    "80-chimeraos_exclude-qemu.conf"
    "60-dracut-remove.hook"
    "90-dracut-install.hook"
)
sha256sums=(
    'SKIP' # dracut-install.sh
    'SKIP' # dracut-remove.sh
    'SKIP' # 00-chimeraos.conf
    'SKIP' # 10-chimeraos_use-fstab.conf
    'SKIP' # 20-chimeraos_include-plymouth.conf
    'SKIP' # 30-chimeraos_include-filesystems.conf
    'SKIP' # 40-chimeraos_exclude-encryption.conf
    'SKIP' # 50-chimeraos_exclude-mdraid.conf
    'SKIP' # 60-chimeraos_exclude-networking.conf
    'SKIP' # 70-chimeraos_exclude-nvdimm.conf
    'SKIP' # 80-chimeraos_exclude-qemu.conf
    'SKIP' # 60-dracut-remove.hook
    'SKIP' # 90-dracut-install.hook
)

package() {
    mkdir -p "$pkgdir/etc/dracut.conf.d/"
    mkdir -p "$pkgdir/usr/local/bin/"
    mkdir -p "$pkgdir/usr/share/libalpm/hooks"
    
    install -m 755 "$srcdir/dracut-install.sh" "$pkgdir/usr/local/bin"
    install -m 755 "$srcdir/dracut-remove.sh" "$pkgdir/usr/local/bin"

    install -m 644 "$srcdir/60-dracut-remove.hook" "$pkgdir/usr/share/libalpm/hooks"
    install -m 644 "$srcdir/90-dracut-install.hook" "$pkgdir/usr/share/libalpm/hooks"

    install -m 644 "$srcdir/00-chimeraos.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/10-chimeraos_use-fstab.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/20-chimeraos_include-plymouth.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/30-chimeraos_include-filesystems.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/40-chimeraos_exclude-encryption.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/50-chimeraos_exclude-mdraid.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/60-chimeraos_exclude-networking.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/70-chimeraos_exclude-nvdimm.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/80-chimeraos_exclude-qemu.conf" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/60-dracut-remove.hook" "$pkgdir/etc/dracut.conf.d"
    install -m 644 "$srcdir/90-dracut-install.hook" "$pkgdir/etc/dracut.conf.d"
}

